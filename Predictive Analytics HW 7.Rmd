---
title: "Predictive Analytics HW 7"
author: "Rachel Jordan"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##  Chapter 9, Exercise 3

#### (a)

```{r}
#enter data
X1 <- c(3,2,4,1,2,4,4)
X2 <- c(4,2,4,4,1,3,1)
Y <- c("Red","Red","Red","Red","Blue","Blue","Blue")
toy <- as.data.frame(cbind(X1,X2,Y))
toy$Y <- factor(toy$Y,levels=c("Red","Blue"))

#create "sketch"
require(tidyverse)
ggplot(toy, aes(x=X1, y=X2)) + geom_point(aes(color=Y))
```

#### (b)

Visually I can tell that this line should be X2 = -0.5 + X1 which is the same as 0.5 - X1 + X2 = 0.

```{r}
#sketch
ggplot(toy, aes(x=X1, y=X2)) + geom_point(aes(color=Y)) + geom_abline(slope=1,intercept=-0.5)
```

#### (c) 

Classify to red if 0.5 - X1 + X2 \> 0 and classify to blue otherwise. B0 = 0.5, B1 = -1, and B2 = 1.

#### (d) 

The margins are created by using -1 and 0 as the intercept. The resulting lines will hit the support vectors.

```{r}
#sketch
ggplot(toy, aes(x=X1, y=X2)) + geom_point(aes(color=Y)) + geom_abline(slope=1,intercept=-0.5) + geom_abline(slope=1, intercept=0, linetype="dotted") + geom_abline(slope=1, intercept=-1,linetype="dotted")
```

#### (e) 

The support vectors are the points (2,2), (2,1), (4,4), and (4,3).

#### (f) 

The 7th observation, (4,1), is not a support vector and would therefore not affect the maximal marginal hyperplane if moved, UNLESS it was moved to be within the margins or across the hyperplane.

#### (g) 

```{r}
#sketch
ggplot(toy, aes(x=X1, y=X2)) + geom_point(aes(color=Y)) + geom_abline(slope=1.1,intercept=-0.5)
```

This is not the optimal separating hyperplane. The equation is X2 = -0.5 + 1.1X1, which is equivalent to 0.5 - 1.1X1 + X2 = 0.

#### (h)

```{r}
#add extra point
X1_2 <- c(3,2,4,1,2,4,4,2)
X2_2 <- c(4,2,4,4,1,3,1,3)
Y_2 <- c("Red","Red","Red","Red","Blue","Blue","Blue","Blue")
toy_2 <- as.data.frame(cbind(X1_2,X2_2,Y_2))
toy_2$Y_2 <- factor(toy_2$Y_2,levels=c("Red","Blue"))

#sketch
ggplot(toy_2, aes(x=X1_2, y=X2_2)) + geom_point(aes(color=Y_2))
```
